rule:
  id: XSS-REFLECTED-002
  name: Reflected XSS Detection
  description: Detects XSS payloads reflected via URL parameters
  severity: high

  logsource:
    category: web_server
    product: apache

  detection:
    selection:
      request_uri|contains:
        - "<script>"
        - "%3Cscript%3E"
        - "alert("
        - "document.cookie"
    condition: selection

  fields:
    - src_ip
    - request_uri
    - http_method

  alert:
    message: "Reflected XSS attempt detected"
    action: "Block request and apply output encoding"
