version: "1.0"
rule_set: "coop_abuse_detection"

rule:
  id: COOP-005
  name: COOP Missing on Error Pages
  severity: low
  confidence: medium
  description: >
    Detects error responses serving HTML content without a
    Cross-Origin-Opener-Policy header.
  conditions:
    all:
      - response.status_code in [400, 401, 403, 500]
      - response.content_type contains "text/html"
      - response.headers.cross-origin-opener-policy not exists
  evidence_fields:
    - response.status_code
    - response.headers.cross-origin-opener-policy
    - request.url
  risk_reason: >
    Error pages without COOP may still allow cross-origin window interaction.
  references:
    - OWASP Secure Headers Project
